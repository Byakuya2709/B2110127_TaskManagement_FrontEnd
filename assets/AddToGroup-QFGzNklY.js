import{_ as m,b as l,o as a,c as d,a as r,w as u,v as p,n as h,d as c,f as v,F as g,k as f,e as _,t as b}from"./index-B8bC3NQi.js";const y={name:"AddUserToGroup",data(){return{group:{description:""},userId:"",users:[],validate:{user:!1,description:!0},isLoading:!1}},computed:{isValidated(){return Object.values(this.validate).every(e=>e)}},methods:{async fetchGroupById(e){this.isLoading=!0;try{const s=await l.get(`/admin/group/${e}`);this.group=s.data.data}catch(s){this.showToastError(s)}finally{this.isLoading=!1}},async fetchAllUsers(){this.isLoading=!0;try{const e=await l.get("/admin/user/no-group");this.users=e.data.data}catch(e){this.showToastError(e)}finally{this.isLoading=!1}},async addUserToGroup(){if(!this.isValidated)return;const e={groupId:this.$route.params.id,userId:this.userId,description:this.group.description};this.isLoading=!0;try{const s=await l.put("/admin/group/add-user",e);this.$toast.success(s.data.message)}catch(s){this.showToastError(s)}finally{this.isLoading=!1}},validateUserId(e){this.validate.user=!!e},validateDescription(){this.validate.description=!!this.group.description.trim()},showToastError(e){var s,n;console.error("Error:",e),this.$toast.error(((n=(s=e.response)==null?void 0:s.data)==null?void 0:n.message)||e.message)},resetForm(){this.userId="",this.group.description="",this.validate.user=!0,this.validate.description=!0}},created(){const e=this.$route.params.id;this.fetchGroupById(e),this.fetchAllUsers()}},I={class:"mb-3"},T=r("label",{for:"groupName",class:"form-label"},"Tên nhóm:",-1),k={class:"mb-3"},L=r("label",{for:"description",class:"form-label"},"Mô tả:",-1),U={key:0,class:"invalid-feedback"},w={class:"mb-3"},V=r("label",{for:"userId",class:"form-label"},"Nhân viên:",-1),G=r("option",{value:"",disabled:""},"Chọn một nhân viên",-1),x=["value"],D={key:0,class:"invalid-feedback"},E=["disabled"],N={key:0,class:"spinner-border",role:"status"},B=r("span",{class:"visually-hidden"},"Loading...",-1),M=[B];function A(e,s,n,C,t,o){return a(),d("form",{onSubmit:s[5]||(s[5]=_((...i)=>o.addUserToGroup&&o.addUserToGroup(...i),["prevent"]))},[r("div",I,[T,u(r("input",{type:"text",class:"form-control",id:"groupName","onUpdate:modelValue":s[0]||(s[0]=i=>t.group.name=i),readonly:""},null,512),[[p,t.group.name]])]),r("div",k,[L,u(r("textarea",{class:h(["form-control",{"is-invalid":!t.validate.description&&t.group.description!==void 0}]),id:"description","onUpdate:modelValue":s[1]||(s[1]=i=>t.group.description=i),onInput:s[2]||(s[2]=(...i)=>o.validateDescription&&o.validateDescription(...i))},null,34),[[p,t.group.description]]),!t.validate.description&&t.group.description!==void 0?(a(),d("div",U," Mô tả không được bỏ trống. ")):c("",!0)]),r("div",w,[V,u(r("select",{class:h(["form-select",{"is-invalid":!t.validate.user}]),id:"userId","onUpdate:modelValue":s[3]||(s[3]=i=>t.userId=i),onChange:s[4]||(s[4]=i=>o.validateUserId(t.userId))},[G,(a(!0),d(g,null,f(t.users,i=>(a(),d("option",{key:i.id,value:i.id},b(i.fullname),9,x))),128))],34),[[v,t.userId]]),t.validate.user?c("",!0):(a(),d("div",D," Nhân viên không được bỏ trống. "))]),r("button",{type:"submit",class:"btn btn-primary",disabled:!o.isValidated||t.isLoading}," Thêm nhân viên vào nhóm ",8,E),t.isLoading?(a(),d("div",N,M)):c("",!0)],32)}const S=m(y,[["render",A]]);export{S as default};
