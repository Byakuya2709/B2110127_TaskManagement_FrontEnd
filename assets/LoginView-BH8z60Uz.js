import{_ as f,u as v,r as w,o as n,c,a as t,e as C,w as h,v as _,d as m,j as k,g as p,h as u,i as g}from"./index-DJbuJOQH.js";const x=""+new URL("logo-CXPaiM3t.png",import.meta.url).href,b={name:"Login",data(){return{email:"",password:"",validated:{},captchaError:!1,isCaptchaChecked:!1}},watch:{email(e){this.validateEmail(e)},password(e){this.validatePassword(e)}},computed:{isValidated(){return this.validated.email&&this.validated.password}},methods:{onCaptchaClick(){typeof grecaptcha<"u"?grecaptcha.ready(()=>{grecaptcha.execute("6LeN92gqAAAAAOrMZ62v0Cs1T1WBSm6hKFKMS8y9",{action:"login"}).then(e=>{this.loginUser(e)}).catch(()=>{this.captchaError=!0})}):this.captchaError=!0},async loginUser(e){var a,d;if(!this.isValidated||!e){this.$toast.error("Vui lòng điền đầy đủ thông tin yêu cầu và xác minh CAPTCHA.");return}try{const r={email:this.email,password:this.password,recaptchaToken:e},s=v(),{response:o,role:l}=await s.login(r);o.status===200?(this.$toast.success(o.data.message),setTimeout(l==="ROLE_ADMIN"?()=>{this.$router.push("/admin").then(()=>window.location.reload())}:()=>{this.$router.push("/user").then(()=>window.location.reload())},2e3)):this.$toast.warning(o.data.message)}catch(r){this.$toast.error(((d=(a=r.response)==null?void 0:a.data)==null?void 0:d.message)||"Đã xảy ra lỗi")}},validateEmail(e){this.validated.email=/.+@.+\.(com|vn)$/.test(e)},validatePassword(e){this.validated.password=/^(?=.*[a-z])(?=.*\d).{8,}$/.test(e)}}},y={class:"login bg-light"},V={class:"d-flex justify-content-center align-items-center vh-100"},A={class:"d-flex max-w-4xl mt-5"},E={class:"bg-white p-4 border border-dark"},M=t("h1",{class:"text-dark text-center mb-4"},"Đăng Nhập",-1),T={class:"mb-3"},N=t("label",{for:"email",class:"form-label"},"Email",-1),P={key:0,class:"text-danger mt-1"},L={class:"mb-3"},S=t("label",{for:"password",class:"form-label"},"Mật Khẩu",-1),U={key:0,class:"text-danger mt-1"},B={class:"mb-3"},K=t("label",{for:"captchaCheck",class:"form-check-label"}," Tôi đã xác minh CAPTCHA ",-1),j={class:"mb-3 d-flex justify-content-center align-items-center"},H=["disabled"],q={class:"text-center mt-3"},D={key:0,class:"text-danger mt-1"},O={class:"form-img"},R=t("img",{src:x,alt:""},null,-1);function z(e,a,d,r,s,o){const l=w("router-link");return n(),c("div",y,[t("div",V,[t("div",A,[t("div",E,[M,t("form",{onSubmit:a[3]||(a[3]=C((...i)=>o.onCaptchaClick&&o.onCaptchaClick(...i),["prevent"]))},[t("div",T,[N,h(t("input",{type:"email",placeholder:"Email","onUpdate:modelValue":a[0]||(a[0]=i=>s.email=i),class:"form-control"},null,512),[[_,s.email]]),s.validated.email?m("",!0):(n(),c("p",P," Vui lòng nhập email hợp lệ. "))]),t("div",L,[S,h(t("input",{autocomplete:"off",required:"",type:"password",placeholder:"Password","onUpdate:modelValue":a[1]||(a[1]=i=>s.password=i),class:"form-control"},null,512),[[_,s.password]]),s.validated.password?m("",!0):(n(),c("p",U," Mật khẩu phải gồm ít nhất chữ thường, số và không được dưới 8 kí tự. "))]),t("div",B,[h(t("input",{type:"checkbox","onUpdate:modelValue":a[2]||(a[2]=i=>s.isCaptchaChecked=i),id:"captchaCheck"},null,512),[[k,s.isCaptchaChecked]]),K]),t("div",j,[t("input",{type:"submit",value:"Login",class:"btn btn-primary w-50",disabled:!o.isValidated||!s.isCaptchaChecked},null,8,H)]),t("div",q,[p(l,{to:"/forgot-password",class:"text-secondary"},{default:u(()=>[g(" Quên mật khẩu? ")]),_:1})])],32),s.captchaError?(n(),c("p",D," Vui lòng xác minh CAPTCHA. ")):m("",!0)]),t("div",O,[p(l,{to:"/"},{default:u(()=>[R]),_:1}),p(l,{title:"Sign-up",to:"/signup",class:"sign-link mt-3"},{default:u(()=>[g(" Đăng Ký ")]),_:1})])])])])}const I=f(b,[["render",z]]);export{I as default};
