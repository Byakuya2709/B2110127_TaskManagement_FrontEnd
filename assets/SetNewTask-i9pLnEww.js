import{_ as k,b as h,o as l,c as r,a as t,w as d,v as p,n as u,d as n,J as g,f as v,F as _,k as f,e as y,t as b,p as I,l as T}from"./index-C4bAc271.js";const U={name:"SetNewTask",data(){return{users:[],groups:[],title:"",description:"",date:"",status:"",userId:"",groupId:"",assignmentType:"user",validate:{title:!1,description:!1,date:!1,status:!1,user:!1,group:!1}}},created(){this.fetchAllUser(),this.fetchAllGroups(),this.setUserIdFromParam()},methods:{async fetchAllUser(){try{const e=await h.get("/admin/user/all");this.users=e.data.data}catch(e){this.$toast.error(e.response.data.message)}},async fetchAllGroups(){try{const e=await h.get("/admin/group/all");this.groups=e.data.data}catch(e){this.$toast.error(e.response.data.message)}},setUserIdFromParam(){const e=this.$route.params.id;e&&(this.userId=e,this.validateUser(e))},async createTask(){if(!this.isValidated){this.$toast.error("Please fill out all required fields.");return}try{const e={title:this.title,description:this.description,date:this.date,status:this.status,userId:this.assignmentType==="group"?this.getLeaderIdFromGroup(this.groupId):this.userId};console.log("Form Data:",e);const a=await h.post("/admin/task/new",e);console.log("Response:",a.data),this.$toast.success(a.data.message)}catch(e){console.error("Error:",e),this.$toast.error(e.response?e.response.data.message:"An error occurred.")}},getLeaderIdFromGroup(e){const a=this.groups.find(m=>m.id===e);return a?a.leader.leaderId:null},validateTitle(e){this.validate.title=e.length>=6},validateDescription(e){this.validate.description=e.length>=10},validateDate(e){this.validate.date=!!e},validateStatus(e){this.validate.status=!!e},validateUser(e){this.validate.user=!!e},validateGroup(e){this.validate.group=!!e}},watch:{title(e){this.validateTitle(e)},description(e){this.validateDescription(e)},date(e){this.validateDate(e)},status(e){this.validateStatus(e)},userId(e){this.validateUser(e)},groupId(e){this.validateGroup(e)}},computed:{isValidated(){return this.validate.title&&this.validate.description&&this.validate.date&&this.validate.status&&(this.assignmentType==="user"?this.validate.user:this.validate.group)}}},o=e=>(I("data-v-8105d06c"),e=e(),T(),e),N={class:"mb-3"},S=o(()=>t("label",{for:"title",class:"form-label"},"Tiêu đề:",-1)),V={key:0,class:"invalid-feedback"},w={class:"mb-3"},D=o(()=>t("label",{for:"description",class:"form-label"},"Mô tả:",-1)),G={key:0,class:"invalid-feedback"},P={class:"mb-3"},A=o(()=>t("label",{for:"date",class:"form-label"},"Ngày hoàn thành:",-1)),F={key:0,class:"invalid-feedback"},x={class:"mb-3"},E=o(()=>t("label",{for:"taskAssignment",class:"form-label"},"Phân công cho:",-1)),M=o(()=>t("label",{for:"assignUser"},"Nhân viên",-1)),C=o(()=>t("label",{for:"assignGroup"},"Nhóm ",-1)),L={key:0,class:"mb-3"},R=o(()=>t("label",{for:"userId",class:"form-label"},"Nhân viên:",-1)),B=o(()=>t("option",{value:"",disabled:""},"Select a user",-1)),q=["value"],z={key:0,class:"invalid-feedback"},J={key:1,class:"mb-3"},O=o(()=>t("label",{for:"groupId",class:"form-label"},"Nhóm:",-1)),j=o(()=>t("div",{class:"info-warning"}," Tác vụ sẽ được phân công cho nhóm trưởng của nhóm. ",-1)),H=o(()=>t("option",{value:"",disabled:""},"Select a group",-1)),K=["value"],Q={key:0,class:"invalid-feedback"},W={class:"mb-3"},X=o(()=>t("label",{for:"status",class:"form-label"},"Trạng thái:",-1)),Y=o(()=>t("option",{value:"",disabled:""},"Select status",-1)),Z=o(()=>t("option",{value:"PENDING"},"Pending",-1)),$=o(()=>t("option",{value:"IN_PROGRESS"},"In Progress",-1)),ee=o(()=>t("option",{value:"CANCELED"},"Canceled",-1)),se=[Y,Z,$,ee],te={key:0,class:"invalid-feedback"},ie=["disabled"];function ae(e,a,m,oe,s,c){return l(),r("div",null,[t("form",{onSubmit:a[8]||(a[8]=y((...i)=>c.createTask&&c.createTask(...i),["prevent"]))},[t("div",N,[S,d(t("input",{type:"text",class:u(["form-control",{"is-invalid":!s.validate.title}]),id:"title","onUpdate:modelValue":a[0]||(a[0]=i=>s.title=i)},null,2),[[p,s.title]]),!s.validate.title&&!s.title?(l(),r("div",V," Tiêu đề không được ít hơn 6 kí tự. ")):n("",!0)]),t("div",w,[D,d(t("textarea",{class:u(["form-control",{"is-invalid":!s.validate.description}]),id:"description","onUpdate:modelValue":a[1]||(a[1]=i=>s.description=i)},null,2),[[p,s.description]]),!s.validate.description&&!s.description?(l(),r("div",G," Mô tả không được ít hơn 10 kí tự. ")):n("",!0)]),t("div",P,[A,d(t("input",{type:"date",class:u(["form-control",{"is-invalid":!s.validate.date&&!s.date}]),id:"date","onUpdate:modelValue":a[2]||(a[2]=i=>s.date=i)},null,2),[[p,s.date]]),s.validate.date?n("",!0):(l(),r("div",F," Ngày hoàn thành không được bỏ trống. "))]),t("div",x,[E,t("div",null,[d(t("input",{type:"radio",id:"assignUser",value:"user","onUpdate:modelValue":a[3]||(a[3]=i=>s.assignmentType=i)},null,512),[[g,s.assignmentType]]),M,d(t("input",{type:"radio",id:"assignGroup",value:"group","onUpdate:modelValue":a[4]||(a[4]=i=>s.assignmentType=i)},null,512),[[g,s.assignmentType]]),C])]),s.assignmentType==="user"?(l(),r("div",L,[R,d(t("select",{class:u(["form-select",{"is-invalid":!s.validate.user}]),id:"userId","onUpdate:modelValue":a[5]||(a[5]=i=>s.userId=i)},[B,(l(!0),r(_,null,f(s.users,i=>(l(),r("option",{key:i.id,value:i.id},b(i.fullname),9,q))),128))],2),[[v,s.userId]]),!s.validate.user&&!s.userId?(l(),r("div",z," Nhân viên thực hiện tác vụ không được bỏ trống. ")):n("",!0)])):n("",!0),s.assignmentType==="group"?(l(),r("div",J,[O,j,d(t("select",{class:u(["form-select",{"is-invalid":!s.validate.group}]),id:"groupId","onUpdate:modelValue":a[6]||(a[6]=i=>s.groupId=i)},[H,(l(!0),r(_,null,f(s.groups,i=>(l(),r("option",{key:i.id,value:i.id},b(i.name),9,K))),128))],2),[[v,s.groupId]]),!s.validate.group&&!s.groupId?(l(),r("div",Q," Nhóm thực hiện tác vụ không được bỏ trống. ")):n("",!0)])):n("",!0),t("div",W,[X,d(t("select",{class:u(["form-select",{"is-invalid":!s.validate.status}]),id:"status","onUpdate:modelValue":a[7]||(a[7]=i=>s.status=i)},se,2),[[v,s.status]]),!s.validate.status&&!s.status?(l(),r("div",te," Trạng thái tác vụ không được bỏ trống. ")):n("",!0)]),t("button",{type:"submit",class:"btn btn-primary",disabled:!c.isValidated}," Tạo Tác Vụ ",8,ie)],32)])}const re=k(U,[["render",ae],["__scopeId","data-v-8105d06c"]]);export{re as default};
